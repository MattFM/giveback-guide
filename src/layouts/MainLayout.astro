---
import BaseHead from "../components/layout/BaseHead.astro";
import Header from "../components/layout/Header.astro";
import Footer from "../components/layout/Footer.astro";
import SubscribeDrawer from "../components/features/popups/SubscribeDrawer.astro";
import NewsletterModal from "../components/features/popups/NewsletterModal.astro";

interface Props {
  title?: string; // Accept the title prop
  description?: string; // Accept the description prop
  image?: string; // Accept the image prop
  headerVariant?: 'default' | 'transparent'; // Header display mode
  headerTheme?: 'light' | 'dark'; // Header text/icon color theme
}

const { 
  title, 
  description, 
  image, 
  headerVariant = 'default',
  headerTheme = 'light' 
} = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={title} description={description} image={image} />
  </head>
  <body>
  <Header variant={headerVariant} theme={headerTheme} />
    <slot />
    <Footer />
    <NewsletterModal />
  </body>
</html>

  <script is:inline>
    (function () {
      // Adjust header top offset when announcement is present and header is absolutely positioned
      function adjustHeaderTop() {
        try {
          var ann = document.getElementById('site-announcement');
          var hdr = document.querySelector('header[role="banner"]');
          if (!hdr) return;

          var computed = window.getComputedStyle(hdr);
          var isAbsolute = computed.position === 'absolute' || hdr.className.indexOf('absolute') !== -1;
          if (ann && isAbsolute) {
            var h = Math.ceil(ann.getBoundingClientRect().height);
            hdr.style.top = h + 'px';
          } else {
            hdr.style.top = '';
          }
        } catch (e) {
          // silent
        }
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', adjustHeaderTop);
      } else {
        adjustHeaderTop();
      }

      window.addEventListener('resize', function () {
        // debounce
        if (window.__adjustHeaderTopTimeout) clearTimeout(window.__adjustHeaderTopTimeout);
        window.__adjustHeaderTopTimeout = setTimeout(function () {
          adjustHeaderTop();
        }, 120);
      });

      // Observe DOM changes so removal/dismissal of announcement updates header
      var observer = new MutationObserver(function () {
        adjustHeaderTop();
      });
      observer.observe(document.body, { childList: true, subtree: true });
    })();
  </script>
